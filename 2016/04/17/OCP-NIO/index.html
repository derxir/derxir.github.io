<!DOCTYPE html><html lang="null"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>OCP-NIO | Justin Yue</title><link rel="stylesheet" type="text/css" href="/blog/css/normalize.css"><link rel="stylesheet" type="text/css" href="/blog/css/pure-min.css"><link rel="stylesheet" type="text/css" href="/blog/css/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/blog/css/style.css"><link rel="Shortcut Icon" type="image/x-icon" href="/blog/favicon.ico"><link rel="apple-touch-icon" href="/blog/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/blog/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">OCP-NIO</h1><a id="logo" href="/blog/.">Justin Yue</a><p class="description">Focusing on Concepts, learning by doing, consistent summarizing</p></div><div id="nav-menu"><a href="/blog/." class="current"><i class="icon-home"> 首页</i></a><a href="/blog/archives/"><i class="icon-archive"> 归档</i></a><a href="/blog/about/"><i class="icon-about"> 关于</i></a><a href="/blog/atom.xml"><i class="icon-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post post-page"><h1 class="post-title">OCP-NIO</h1><div class="post-meta">2016-04-17 | </div><span data-disqus-identifier="2016/04/17/OCP-NIO/" class="disqus-comment-count"></span><div class="post-content"><p>Path</p>
<p>Path objects are userd to represent the path of files or directories in a file system. They represent a hierarchal path, containing directory names and filenames separated by platform-sepcific delimiters. all methods dont remove any redundancies from the Path object except normalize()</p>
<p>interface java.nio.file.Path</p>
<p>path object might or might not be tied to real file or directory on a system, it can refer to a  nonexistent file or directory.</p>
<p><strong>how to create a path object</strong></p>
<ol>
<li><p>java.nio.file.Paths.get(String path);<br> Paths is a factory class, used to created Path object.<br> back slash () in Java string must be escaped<br> it is a static method</p>
</li>
<li><p>java.nio.file.FileSystems.getDefault().getPath(“&lt;abs/rel path”);<br> Filesystems is an abstract class, need to call getDefault() to get the current class fileSystem object.</p>
</li>
<li><p>java.io.File</p>
<pre><code>File file = new File(&quot;C://a.txt&quot;);
Path path = file.toPath();
</code></pre></li>
</ol>
<p>X. behind the scene, both Paths.get() and File.toPath call FileSystem.getDefault().getPath();</p>
<p><strong>Path vs Paths</strong></p>
<p>Path is an interface while Paths is a class.<br>Paths is actually a utility class with static methods to create Path objects.<br>Path interface is used to represent the path of a file or directory on a system. It extends Comparable, Iterable, and Watchable.</p>
<p>Methods to access path components</p>
<p>Paths.get(“C:\Users\obj8\8-1.txt”);<br>getParent();<br>subPath(0,2);<br>getRoot();<br>getName(0);<br>getName(1);<br>getFileName();<br>getNameCount();</p>
<p>Path methods that accepts positions throw an IllegalArgumentException at runtime for invalid position</p>
<p><strong>compare paths</strong></p>
<p><strong>convert relative to absolute path</strong></p>
<p>##file.toAbsolutePath(), not getAbsolutePath()##</p>
<p>normalize a path<br>path.normalize() // remove .. or ., again, it doesnt check the actual file system,purely object manipulation<br>Path is immutable</p>
<p>Which methods that will not include .. or . in the path object?<br>    toSting()<br>    getName()<br>    subPath(1,2)<br>    getParent()</p>
<p><strong>Resolving path using resolve() and resolveSibling()</strong></p>
<p>resolve(string) resolve(path) are used to join paths. if the param is a absolute path, then the return is the absolute path.</p>
<p>resolveSibling(string) resoveSibling(path) used to copy or rename path. if param is empty, return parent path.    </p>
<p>method relativize(): build a path from path1 to path2<br>file.relative(dir); file –&gt; dir<br>note: cant create path between relative path and absolute path. will throw IllegalArgumentException at runtime.</p>
<p><strong>java.nio.file.Files</strong></p>
<p>consists entirely of static methods for manipulatinf files and dirs</p>
<p>public static Path createFile(Path path…) throws IOException;<br>    atomically check&amp;create</p>
<p>public static Path createDirectory(Path dir…) throws IOException;<br>    atomically check&amp;create throws exception if parent directory doesnt exists</p>
<p>public static Path createDirectories(Path dir …) throws IOException;<br>    create all the parent directories if they dont exist.</p>
<p>notice all throw IOException which is a checked exception</p>
<p><strong>check for the existence of files and dirs</strong><br>exists(Path, LinkOption) notExists(Path, LinkOption)<br>    LinkOption.NOFOLLOW_LINK<br>    both return false if cant determin the existence of the file<br>    by default the methods follow a symbolic link.</p>
<p><strong>Copy files</strong><br>static Files.copy(source,target, CopyOption…)<br>    InputStream -&gt; Path<br>    Path -&gt; OutputStream<br>    Path -&gt; Path<br>    optional third argument StandardCopyOption(enum):<br>        ATOMIC_MOVE, COPY_ATTRIBUTES, REPLACE_EXISTING<br>    can copy only files, not directories. if the source is a dir, then the target dir is created without copying any file in source dir.<br>This method copies a file to the target file with the options parameter specifying how the copy is performed. By default, the copy fails if the target file already exists or is a symbolic link, except if the source and target are the same file, in which case the method completes without copying the file. File attributes are not required to be copied to the target file. If symbolic links are supported, and the file is a symbolic link, then the final target of the link is copied. If the file is a directory then it creates an empty directory in the target location (entries in the directory are not copied).  The options parameter may include any of the following:  REPLACE_EXISTING     If the target file exists, then the target file is replaced if it is not a non-empty directory. If the target file exists and is a symbolic link, then the symbolic link itself, not the target of the link, is replaced.  COPY_ATTRIBUTES     Attempts to copy the file attributes associated with this file to the target file. The exact file attributes that are copied is platform and file system dependent and therefore unspecified. Minimally, the last-modified-time is copied to the target file if supported by both the source and target file store. Copying of file timestamps may result in precision loss.  NOFOLLOW_LINKS     Symbolic links are not followed. If the file is a symbolic link, then the symbolic link itself, not the target of the link, is copied. It is implementation specific if file attributes can be copied to the new link. In other words, the COPY_ATTRIBUTES option may be ignored when copying a symbolic link. An implementation of this interface may support additional implementation specific options.  Copying a file is not an atomic operation. If an IOException is thrown then it possible that the target file is incomplete or some of its file attributes have not been copied from the source file. When the REPLACE_EXISTING option is specified and the target file exists, then the target file is replaced. The check for the existence of the file and the creation of the new file may not be atomic with respect to other file system activities.</p>
<p>static Files.move(source, target,CopyOption)<br>    move or rename a file<br>    Path source = Paths.get(“note.txt”);<br>    Files.move(source, source.resolveSibling(“new-note.txt”));<br>    cant move a file or dir to a nonexisting dir</p>
<p>static void Files.delete(Path)<br>static boolean Files.deleteIfExists(Path)</p>
<p><strong>General Exceptions</strong><br>    IOException(checked)<br>    NoSuchFileException(Runtime) delte move copy a nonexistent file or dir</p>
<p>FileInputStream, FileOutputStream, and RandomAccessFile do have a getChannel method that returns a FileChannel.</p>
<p>You can create files in any directory using File class’s API.<br>Instances of the File class are immutable; that is, once created, the abstract pathname represented by a File object will never change.<br>A BufferedReader can wrap any Reader. Both FileReader and BufferedReader are Readers<br>A Reader can’t be converted into a Writer or vice-versa<br>FileInputStream, FileOutputStream, and RandomAccessFile do have a getChannel method that returns a FileChannel.<br>A Reader such as a FileReader provides only low level operations such as reading a single character or array of characters. It does not understand the notion of “lines”. BufferedReader “decorates” Reader to provide higher level method readLine() by buffering characters. It is an efficient way of reading characters, character arrays, and lines.  The same relationship exists between FileWriter and BufferedWriter but for writing.<br>Console 的任何method 都不throw checked exception<br>Remember that RandomAccessFile implements DataInput as well as DataOutput interfaces. Therefore, in this case, you can use raf as an instance of DataOutput and call its writeUTF(String) method.<br>java.nio.file.FileVisitResult enum<br>            CONTINUE<br>            SKIP_SIBLINGS<br>            SKIP_SUBTREE<br>            TERMINATE</p>
<p>BasicFileAttributeView<br>            Name                                                                           Type<br>            “lastModifiedTime”                                           FileTime<br>            “lastAccessTime”                                             FileTime<br>            “creationTime”                                                 FileTime<br>            “size”                                                                           Long<br>            “isRegularFile”                                                 Boolean<br>            “isDirectory”                                                     Boolean<br>            “isSymbolicLink”                                               Boolean<br>            “isOther”                                                                      Boolean<br>            “fileKey”                                                                       Object</p>
<p>Reader does not have high level methods such as readLine().</p>
<p>Java.io.Console You can read as well as write only character data from/to it.</p>
<p>WatchService</p>
<p>StandardOpenOption</p>
<p>The following is a list of constants provided by java.nio.file.StandardOpenOption:  APPEND If the file is opened for WRITE access then bytes will be written to the end of the file rather than the beginning.  CREATE Create a new file if it does not exist.  CREATE_NEW Create a new file, failing if the file already exists.  DELETE_ON_CLOSE Delete on close.  DSYNC Requires that every update to the file’s content be written synchronously to the underlying storage device.  READ Open for read access.  SPARSE Sparse file.  SYNC Requires that every update to the file’s content or metadata be written synchronously to the underlying storage device.  TRUNCATE_EXISTING If the file already exists and it is opened for WRITE access, then its length is truncated to 0.  WRITE Open for write access.</p>
<p>D in DSYNC is for data. When you open a file with this attribute, it means that every update to the file’s content will be written synchronously to the underlying storage device. The meta data may still remain unsynchronized. In other words, any change in the data of the file will be written to the storage device synchronously, but any change in the meta data may be batched and written to the storage device later. Thus, it makes file operations a slower as compared to when you open the file without any option.</p>
<p>Remember the following points about Path.subpath(int beginIndex, int endIndex) 1. Indexing starts from 0. 2. Root (i.e. c:) is not considered as the beginning. 3. name at beginIndex is included but name at endIndex is not. 4. paths do not start or end with .  Thus, in case of “c:\finance\data\reports\daily\pnl.txt”, name at 0 is finance and name at 2 is reports. However, since the name at endIndex is excluded, subpath(0, 2) will correspond to finance\data.   The following is the API description for this method:  public Path subpath(int beginIndex, int endIndex) Returns a relative Path that is a subsequence of the name elements of this path. The beginIndex and endIndex parameters specify the subsequence of name elements. The name that is closest to the root in the directory hierarchy has index 0. The name that is farthest from the root has index count-1. The returned Path object has the name elements that begin at beginIndex and extend to the element at index endIndex-1.  Parameters: beginIndex - the index of the first element, inclusive endIndex - the index of the last element, exclusive Returns: a new Path object that is a subsequence of the name elements in this Path Throws: IllegalArgumentException - if beginIndex is negative, or greater than or equal to the number of elements. If endIndex is less than or equal to beginIndex, or larger than the number of elements.</p>
<p>writeObject takes Object OutputStream, readObject takes ObjectInputStream<br>to serialize the objet using the dfault behavior, must call objectOutputStream.defaultWriteObjet())<br>To deserialize the object using the default behavior, you must call objectInputStream.defaultReadObject();. This will ensure that instance fields of Portfolio object are deserialized.</p>
<p>standardOpenOption.CREATE vs CREATE_NEW<br>    CREATE_NEW failed if the file exists, CREATE will overrite the file</p>
<p>Path.relativize() doesnt take a string as a param.</p>
<p>Path.getParent() returns null if it doesnt have a parent.</p>
<p>Files.createDirectories() doesnt throw runtime exception if the file already exists whereas createDirectory() and createFile() throw. It throws exception when the dir is a file but not a dir.</p>
<p>notExists() is not a complement of exists()</p>
<p>copy() returns a Path or a Long but not a Boolean.<br>copy() cannot be used in try-with-resources<br>copy() doesnt copy directories;<br>by default if fails if the file exists. the file followed by the sim-link is copied otherwise use copyOption.NOFOLLOW_LINKS</p>
<p>Attributes:</p>
<p>Dos: isArchive(), isHidden(), isReadOnly(), isSystem()<br>Posix: permissions() group() owner()<br>attributes interface dont provide setter, Views do.<br>acl is windows only<br>fileOnwerAttributeView for all FS.</p>
<p>WatchService<br>    diff between WatchService.take() and poll()<br>    WatchService has two types of methods for retrieving the WatchKeys - poll and take. The two poll methods return null if no key is present and it does not wait for ever. The take method doesn’t return null but keeps waiting until a key is available.</p>
<pre><code>WatchKey take() throws InterruptedException Retrieves and removes next watch key, waiting if none are yet present. Notice that this method does not take any parameter. So it waits until a key becomes available (or until the WatchService is closed, in which case the method throws ClosedWatchServiceException). If you want to wait for a specified time, you should use the poll method. 

WatchKey poll(long timeout,TimeUnit unit) throws InterruptedException : Retrieves and removes the next watch key, waiting if necessary up to the specified wait time if none are yet present. 

 WatchKey poll(): Retrieves and removes the next watch key, or null if none are present.
</code></pre><p>Note that the write(int b) method of various binary stream based classes such as this one take an int parameter but write only the low 8 bits (i.e. 1 byte) of that integer. DataOutputStream provides methods such as writeInt, writeChar, and writeDouble, for writing complete value of the primitives to a file. So if you want to write an integer to the file, you should use writeInt(1) in which case a file of size 4 bytes will be created. You can read back the stored primitives using methods such as DataInputSream.readInt()</p>
<p>public static boolean isSameFile(Path path, Path path2)                           throws IOException  Tests if two paths locate the same file. If both Path objects are equal then this method returns true without checking if the file exists. If the two Path objects are associated with different providers then this method returns false. Otherwise, this method checks if both Path objects locate the same file, and depending on the implementation, may require to open or access both files.</p>
<p>java.nio.file.PathMatcher is an interface that declares only one method:<br> boolean matches(Path path)<br>  Tells if given path matches this matcher’s pattern. </p>
<p>static fields are never serialized.<br>During deserialization, the constructor of the class (or any static or instance blocks) is not executed. However, if the super class does not implement Serializable, its constructor is called.</p>
<ol>
<li>The isDirectory() method returns true if the file object represents a directory.<br>2 and 3. File class has two methods for returning the contents of a directory (although it has more but for the exam, you need to know only these two):<br>String[] list()<br>Returns an array of strings naming the files and directories in the directory denoted by this abstract pathname.<br>File[] listFiles()<br>Returns an array of abstract pathnames denoting the files in the directory denoted by this abstract pathname.  The for loop is expecting ‘files’ to be an array or a Collection of File objects. Thus, 2nd and 3rd blanks should be File[] and listFiles respectively.  </li>
<li>isFile() method returns true if the file object represents a normal file.<ol>
<li>renameTo(File newfile) renames the file to newfile. </li>
</ol>
</li>
</ol>
</div><div class="tags"><a href="/blog/tags/Java/">Java</a></div><div class="post-nav"><a href="/blog/2016/04/30/Thread/" class="pre"><i class="icon-previous">Thread</i></a><a href="/blog/2016/04/15/blockchain/" class="next">blockchain<i class="icon-next"></i></a></div><div id="disqus_thread"><script>var disqus_shortname = 'derxir';
var disqus_identifier = '2016/04/17/OCP-NIO/';
var disqus_title = 'OCP-NIO';
var disqus_url = 'http://jiaweiyue.com/blog/2016/04/17/OCP-NIO/';
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//derxir.disqus.com/count.js" async></script></div></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search" class="search-form-input"/><input type="hidden" name="sitesearch" value="http://jiaweiyue.com/blog"/></form></div><div class="widget"><div class="widget-title">分类</div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/写给自己/">写给自己</a></li></ul></div><div class="widget"><div class="widget-title">标签</div><div class="tagcloud"><a href="/blog/tags/music/" style="font-size: 15px;">music</a> <a href="/blog/tags/阅读笔记/" style="font-size: 15px;">阅读笔记</a> <a href="/blog/tags/diary/" style="font-size: 15px;">diary</a> <a href="/blog/tags/Java/" style="font-size: 15px;">Java</a> <a href="/blog/tags/Coding/" style="font-size: 15px;">Coding</a></div></div><div class="widget"><div class="widget-title">最新文章</div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/blog/2016/12/19/一些句子/">一些句子</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2016/12/13/How-to-read-a-book/">How to read a book</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2016/12/12/post/">post</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2016/06/08/Functional-Programming/">Functional Programming</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2016/06/08/OCP-Class-Design/">OCP-Class Design</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2016/06/08/OCP-Exception/">OCP-Exception</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2016/06/08/OCP-Concurrency/">OCP-Concurrency</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2016/06/08/OCP-Collection/">OCP-Collection</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2016/06/08/OCP-Locale/">OCP-Locale</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2016/06/08/OCP-JDBC/">OCP-JDBC</a></li></ul></div><div class="widget"><div class="widget-title">最近评论</div><script type="text/javascript" src="//derxir.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title">友情链接</div><ul></ul><a href="null" title="null" target="_blank"></a></div></div></div></div><div id="footer">© <a href="/blog/." rel="nofollow">Justin Yue.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div><a id="rocket" href="#top" class="show"></a><script src="/blog/js/jquery.min.js" type="text/javascript"></script>
<script src="/blog/js/totop.js" type="text/javascript"></script><script src="/blog/js/fancybox.pack.js" type="text/javascript"></script>
<script src="/blog/js/jquery.fancybox.js" type="text/javascript"></script><link rel="stylesheet" href="/blog/css/jquery.fancybox.css" type="text/css"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-89047055-1','auto');ga('send','pageview');
</script></div></body></html>